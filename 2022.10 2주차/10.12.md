# 10/12

# [Django] Django 회원가입/로그인📝

## **HTTP 특징** 💭

- 비 연결 지향
  - 서버는 요청에 대한 응답을 보낸 후 연결을 끊음
    - 네이버 메인 페이지를 보고 있을 때 우리는 네이버 서버와 연결되어 있는 것이 아님
    - 네이버 서버는 우리에게 메인 페이지를 응답하고 연결을 끊은 것
- 무상태
  - 연결을 끊은 순간 클라이언트와 서버 간의 통신이 끝나며 상태 정보가 유지되지 않음
  - 클라이언트와 서버가 주고받는 메시지들은 서로 완전히 독립적

### 로그인 상태를 유지하는 이유?💡

- 서버와 클라이언트 간 지속적인 상태 유지를 위해 **"쿠키와 세션"** 이 존재

### 쿠키💡

- 서버가 사용자의 웹 브라우저에 전송하는 작은 데이터 조각
- 사용자가 웹사이트를 방문할 경우 해당 웹사이트의 서버를 통해 사용자의 컴퓨터에 설치되는 작은 기록 정보 파일
- 쿠키는 서로 다른 요청이 동일한 브라우저로부터 발생한 것인지 판단할 때 주로 사용됨

```py
# 쿠키 사용 목적
세션관리: 로그인, 아이디 자동완성, 팝업 체크
개인화: 사용자 선호, 테마 설정 등
트래킹: 사용자 행동을 기록 및 분석

# 쿠키 수명
session cookie: 현재 세션이 종료되면 삭제, 브라우저 종료와 함께 삭제
persistent cookies: Expires 속성에 지정된 날짜나 Max-Age 속성에 지정된 기간이 지나면 삭제됨
```

```py
# Session in Django
Django는 database-backed sessions 저장 방식을 기본 값으로 사용

Django는 특정 session id를 포함하는 쿠키를 사용해서 각각의 브라우저와 사이트가 연결된 session을 확인함
```

### 세션💡

- 사이트와 특정 브라우저 사이의 state를 유지시키는 것
- 클라이언트가 서버에 접속하면 서버가 특정 session id를 발급하고, 클라이언트는 session id를 쿠키에 저장
- session id는 세션을 구별하기 위해 필요하며, 쿠키에는 session id만 저장

### Login💡

- AuthenticationForm(로그인을 위한 built-in form) (request를 첫번째 인자로 받음)

```py
login(request, user, backend=None)
인증된 사용자를 로그인
HttpRequest 객체와 User 객체가 필요: Authenticate()를 사용하면 내부적으로 확인
```

- get_user()

```py
AuthenticationForm의 인스턴스 메서드
유효성 검사를 통과했을 경우 로그인 한 사용자 객체를 반환
```

- 로그인 로직 작성

```py
일반적인 ModelForm 기반의 Create 로직과 동일하지만, Model폼이 아닌 Form으로 필수 인자 구성이 다름

DB에 저장하는 것 대신 세션에 유저를 기록하는 함수를 호출함
```
