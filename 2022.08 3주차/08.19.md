# 8/19

# [DB] CASE ğŸ“

## **CASE** ğŸ’­

- íŠ¹ì • ìƒí™©ì—ì„œ `ë°ì´í„°ë¥¼ ë³€í™˜í•˜ì—¬ í™œìš©`í•  ìˆ˜ ìˆìŒ
- **ELSEë¥¼ ìƒëµí•˜ëŠ” ê²½ìš° NULLê°’ì´ ì§€ì •ë¨**

```sql
CASE
	WHEN ì¡°ê±´ì‹ THEN ì‹
	WHEN ì¡°ê±´ì‹ THEN ì‹
	ELSE ì‹
END
```

```sql
SELECT id, gender
FROM healthcare
LIMIT 5;


-- ì„±ë³„1(ë‚¨ì), 2(ì—¬ì) ğŸ’¡
SELECT
	id,
	CASE
		WHEN gender = 1 THEN 'ë‚¨ì'
		WHEN gender = 2 THEN 'ì—¬ì'
	END AS ì„±ë³„
FROM healthcare
LIMIT 5;


-- í¡ì—° ğŸ’¡
SELECT DISTINCT smoking
FROM healthcare;

SELECT
	id,
	smoking,
	CASE
		WHEN smoking = 1 THEN 'ë¹„í¡ì—°ì'
		WHEN smoking = 2 THEN 'í¡ì—°ì'
		WHEN smoking = 3 THEN 'í—¤ë¹„ìŠ¤ëª¨ì»¤'
		ELSE 'ë¬´ì‘ë‹µ'
	END
FROM healthcare
LIMIT 50;


-- ë‚˜ì´ì— ë”°ë¼ì„œ êµ¬ë¶„í•˜ê¸° ğŸ’¡
SELECT
	first_name,
	last_name,
	CASE
		WHEN age <= 18 THEN 'ì²­ì†Œë…„'
		WHEN age <= 40 THEN 'ì²­ë…„'
		WHEN age <= 90 THEN 'ì¤‘ì¥ë…„'
		ELSE 'ë…¸ë…„'
 END
FROM users
LIMIT 10;
```

---

# [DB] ì„œë¸Œì¿¼ë¦¬ ğŸ“

## **ì„œë¸Œì¿¼ë¦¬** ğŸ’­

- **ì„œë¸Œ ì¿¼ë¦¬ëŠ” íŠ¹ì •í•œ ê°’ì„ ë©”ì¸ ì¿¼ë¦¬ì— ë°˜í™˜í•˜ì—¬ í™œìš©í•˜ëŠ” ê²ƒ**
- ì‹¤ì œ í…Œì´ë¸”ì— ì—†ëŠ” ê¸°ì¤€ì„ ì´ìš©í•œ ê²€ìƒ‰ì´ ê°€ëŠ¥í•¨
- ì„œë¸Œ ì¿¼ë¦¬ëŠ” `ì†Œê´„í˜¸ë¡œ ê°ì‹¸ì„œ ì‚¬ìš©`í•˜ë©°, `ë©”ì¸ ì¿¼ë¦¬ì˜ ì¹¼ëŸ¼ì„ ëª¨ë‘ ì‚¬ìš©`í•  ìˆ˜ ìˆìŒ
- ë©”ì¸ ì¿¼ë¦¬ëŠ” ì„œë¸Œ ì¿¼ë¦¬ì˜ ì¹¼ëŸ¼ì„ ì´ìš©í•  ìˆ˜ ìˆìŒ

### **ë‹¨ì¼í–‰ ì„œë¸Œì¿¼ë¦¬**

- ì„œë¸Œì¿¼ë¦¬ì˜ ê²°ê³¼ê°€ 0 ë˜ëŠ” 1ê°œì¸ ê²½ìš°
- `ë‹¨ì¼í–‰ ë¹„êµ ì—°ì‚°ìì™€ í•¨ê»˜ ì‚¬ìš© (=, <, <=, >=, >, <>)`

```sql
-- usersì—ì„œ ê°€ì¥ ë‚˜ì´ê°€ ì‘ì€ ì‚¬ëŒì˜ ìˆ˜ëŠ”? ğŸ’­
SELECT age, count(*) FROM users GROUP BY age ORDER BY age LIMIT 1;
-- ê°€ì¥ ì‘ì€ ë‚˜ì´
SELECT min(age) FROM users;
-- ê°€ì¥ ì‘ì€ ë‚˜ì´ì˜ ìˆ˜
SELECT count(*) FROM users WHERE age = 15;
-- ë‹¨ì¼í–‰ ì„œë¸Œì¿¼ë¦¬ ğŸ’¡
SELECT count(*) FROM users WHERE age = (SELECT min(age) FROM users);


-- userì—ì„œ í‰ê·  ê³„ì¢Œ ì”ê³ ê°€ ë†’ì€ ì‚¬ëŒì˜ ìˆ˜ëŠ”? ğŸ’­
SELECT count(*) FROM users WHERE balance > (SELECT avg(balance) FROM users);


-- usersì—ì„œ ìœ ì€ì •ê³¼ ê°™ì€ ì§€ì—­ì— ì‚¬ëŠ” ì‚¬ëŒì˜ ìˆ˜ëŠ”? ğŸ’­
SELECT count(*) FROM users WHERE country = (SELECT country FROM users WHERE last_name = 'ìœ ' AND first_name = 'ì€ì •');


-- ì „ì²´ ì¸ì›ê³¼ í‰ê·  ì—°ë´‰, í‰ê·  ë‚˜ì´ë¥¼ ì¶œë ¥í•˜ì„¸ìš”. ğŸ’­
SELECT count(*), avg(balance), avg(age) FROM users;


-- usersì—ì„œ ì´ì¸ì›ê³¼ í‰ê· ì—°ë´‰ì„ ë³´ì—¬ì¤˜ ğŸ’­
SELECT
	(SELECT count(*) FROM users) AS ì´ì¸ì›,
	(SELECT avg(balance) FROM users) AS í‰ê· ì—°ë´‰;


-- usersì˜ ì—°ë´‰ì„ ëª¨ë‘ í‰ê· ì—°ë´‰ìœ¼ë¡œ ë°”ê¿”ì¤˜ ğŸ’­
UPDATE users
SET balance = (SELECT avg(balance) FROM users);
```

### **ë‹¤ì¤‘í–‰ ì„œë¸Œì¿¼ë¦¬**

- ì„œë¸Œì¿¼ë¦¬ ê²°ê³¼ê°€ 2ê°œ ì´ìƒì¸ ê²½ìš°
- `ë‹¤ì¤‘í–‰ ë¹„êµ ì—°ì‚°ìì™€ í•¨ê»˜ ì‚¬ìš© (IN, EXISTS ë“±)`

```sql
SELECT
	country
FROM users
WHERE last_name = 'ì´' AND first_name = 'ì€ì •';


-- ìœ ì€ì •ê³¼ ê°™ì€ ì§€ì—­ì— ì‚¬ëŠ” ì‚¬ëŒì˜ ìˆ˜ëŠ”? ğŸ’­
SELECT
	count(*)
FROM users
WHERE country IN (SELECT country FROM users WHERE last_name = 'ìœ ' AND first_name = 'ì€ì •');


-- íŠ¹ì • ì„±ì”¨ì—ì„œ ê°€ì¥ ì–´ë¦° ì‚¬ëŒë“¤ì˜ ì´ë¦„ê³¼ ë‚˜ì´ëŠ”? ğŸ’­
SELECT
	last_name,
	first_name,
	age
FROM users
WHERE (last_name, age) IN (
  SELECT
  	last_name,
  	min(age)
  FROM users
  GROUP BY last_name)
ORDER BY last_name;
```

### **ë‹¤ì¤‘ì»¬ëŸ¼ ì„œë¸Œì¿¼ë¦¬**

```sql
-- ID ì¡°íšŒ
SELECT ArtistId
FROM artists
WHERE Name = 'AC/DC';

-- ì„œë¸Œì¿¼ë¦¬
SELECT *
FROM albums
WHERE ArtistId = (
  SELECT ArtistId
  FROM artists
  WHERE Name = 'Queen');
```

# âœ… ì‹¤ìŠµ ë¬¸ì œ

## 4ì¼ì°¨ ì‹¤ìŠµ

<br>

### 1. ëª¨ë“  í…Œì´ë¸”ì˜ ì´ë¦„ì„ ì¶œë ¥í•˜ì„¸ìš”.

```bash
sqlite> .header on
sqlite> .mode column
sqlite> .tables
albums          employees       invoices        playlists
artists         genres          media_types     tracks
customers       invoice_items   playlist_track
```

### 2. ëª¨ë“  í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.

| ê³µë°±ì€ ìˆëŠ”ì§€ NULLì€ ìˆëŠ”ì§€ ë°ì´í„° íƒ€ì…ì€ ì–´ë–¤ì§€ ë“±ë“± ë°ì´í„°ë¥¼ ì§ì ‘ í™•ì¸í•´ë³´ì„¸ìš”.

```bash
sqlite> .schema
CREATE TABLE IF NOT EXISTS "albums"
(
    [AlbumId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [Title] NVARCHAR(160)  NOT NULL,
    [ArtistId] INTEGER  NOT NULL,
    FOREIGN KEY ([ArtistId]) REFERENCES "artists" ([ArtistId])
                ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE sqlite_sequence(name,seq);
CREATE TABLE IF NOT EXISTS "artists"
(
    [ArtistId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [Name] NVARCHAR(120)
);
CREATE TABLE IF NOT EXISTS "customers"
(
    [CustomerId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [FirstName] NVARCHAR(40)  NOT NULL,
    [LastName] NVARCHAR(20)  NOT NULL,
    [Company] NVARCHAR(80),
    [Address] NVARCHAR(70),
    [City] NVARCHAR(40),
    [State] NVARCHAR(40),
    [Country] NVARCHAR(40),
    [PostalCode] NVARCHAR(10),
    [Phone] NVARCHAR(24),
    [Fax] NVARCHAR(24),
    [Email] NVARCHAR(60)  NOT NULL,
    [SupportRepId] INTEGER,
    FOREIGN KEY ([SupportRepId]) REFERENCES "employees" ([EmployeeId])
                ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE IF NOT EXISTS "employees"
(
    [EmployeeId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [LastName] NVARCHAR(20)  NOT NULL,
    [FirstName] NVARCHAR(20)  NOT NULL,
    [Title] NVARCHAR(30),
    [ReportsTo] INTEGER,
    [BirthDate] DATETIME,
    [HireDate] DATETIME,
    [Address] NVARCHAR(70),
    [City] NVARCHAR(40),
    [State] NVARCHAR(40),
    [Country] NVARCHAR(40),
    [PostalCode] NVARCHAR(10),
    [Phone] NVARCHAR(24),
    [Fax] NVARCHAR(24),
    [Email] NVARCHAR(60),
    FOREIGN KEY ([ReportsTo]) REFERENCES "employees" ([EmployeeId])
                ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE IF NOT EXISTS "genres"
(
    [GenreId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [Name] NVARCHAR(120)
);
CREATE TABLE IF NOT EXISTS "invoices"
(
    [InvoiceId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [CustomerId] INTEGER  NOT NULL,
    [InvoiceDate] DATETIME  NOT NULL,
    [BillingAddress] NVARCHAR(70),
    [BillingCity] NVARCHAR(40),
    [BillingState] NVARCHAR(40),
    [BillingCountry] NVARCHAR(40),
    [BillingPostalCode] NVARCHAR(10),
    [Total] NUMERIC(10,2)  NOT NULL,
    FOREIGN KEY ([CustomerId]) REFERENCES "customers" ([CustomerId])
                ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE IF NOT EXISTS "invoice_items"
(
    [InvoiceLineId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [InvoiceId] INTEGER  NOT NULL,
    [TrackId] INTEGER  NOT NULL,
    [UnitPrice] NUMERIC(10,2)  NOT NULL,
    [Quantity] INTEGER  NOT NULL,
    FOREIGN KEY ([InvoiceId]) REFERENCES "invoices" ([InvoiceId])
                ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY ([TrackId]) REFERENCES "tracks" ([TrackId])
                ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE IF NOT EXISTS "media_types"
(
    [MediaTypeId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [Name] NVARCHAR(120)
);
CREATE TABLE IF NOT EXISTS "playlists"
(
    [PlaylistId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [Name] NVARCHAR(120)
);
CREATE TABLE IF NOT EXISTS "playlist_track"
(
    [PlaylistId] INTEGER  NOT NULL,
    [TrackId] INTEGER  NOT NULL,
    CONSTRAINT [PK_PlaylistTrack] PRIMARY KEY  ([PlaylistId], [TrackId]),
    FOREIGN KEY ([PlaylistId]) REFERENCES "playlists" ([PlaylistId])
                ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY ([TrackId]) REFERENCES "tracks" ([TrackId])
                ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE IF NOT EXISTS "tracks"
(
    [TrackId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    [Name] NVARCHAR(200)  NOT NULL,
    [AlbumId] INTEGER,
    [MediaTypeId] INTEGER  NOT NULL,
    [GenreId] INTEGER,
    [Composer] NVARCHAR(220),
    [Milliseconds] INTEGER  NOT NULL,
    [Bytes] INTEGER,
    [UnitPrice] NUMERIC(10,2)  NOT NULL,
    FOREIGN KEY ([AlbumId]) REFERENCES "albums" ([AlbumId])
                ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY ([GenreId]) REFERENCES "genres" ([GenreId])
                ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY ([MediaTypeId]) REFERENCES "media_types" ([MediaTypeId])
                ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE INDEX [IFK_AlbumArtistId] ON "albums" ([ArtistId]);
CREATE INDEX [IFK_CustomerSupportRepId] ON "customers" ([SupportRepId]);
CREATE INDEX [IFK_EmployeeReportsTo] ON "employees" ([ReportsTo]);
CREATE INDEX [IFK_InvoiceCustomerId] ON "invoices" ([CustomerId]);
CREATE INDEX [IFK_InvoiceLineInvoiceId] ON "invoice_items" ([InvoiceId]);
CREATE INDEX [IFK_InvoiceLineTrackId] ON "invoice_items" ([TrackId]);
CREATE INDEX [IFK_PlaylistTrackTrackId] ON "playlist_track" ([TrackId]);
CREATE INDEX [IFK_TrackAlbumId] ON "tracks" ([AlbumId]);
CREATE INDEX [IFK_TrackGenreId] ON "tracks" ([GenreId]);
CREATE INDEX [IFK_TrackMediaTypeId] ON "tracks" ([MediaTypeId]);
CREATE TABLE sqlite_stat1(tbl,idx,stat);
```

```sql
SELECT * FROM albums;
SELECT * FROM employees;
SELECT * FROM invoices;
SELECT * FROM playlists;
SELECT * FROM artists;
SELECT * FROM genres;
SELECT * FROM media_types;
SELECT * FROM tracks;
SELECT * FROM customers;
SELECT * FROM invoice_items;
SELECT * FROM playlist_track;
```

### 3. ì•¨ë²”(albums) í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, `Title`ì„ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœí•´ì„œ 5ê°œê¹Œì§€ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT * FROM albums ORDER BY Title DESC LIMIT 5;
```

```
AlbumId  Title                         ArtistId
-------  ----------------------------  --------
208      [1997] Black Light Syndrome   136
240      Zooropa                       150
267      Worlds                        202
334      Weill: The Seven Deadly Sins  264
8        Warner 25 Anos                6
```

### 4. ê³ ê°(customers) í…Œì´ë¸”ì˜ í–‰ ê°œìˆ˜ë¥¼ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, ì»¬ëŸ¼ëª…ì„ `ê³ ê° ìˆ˜`ë¡œ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT COUNT(*) AS "ê³ ê° ìˆ˜" FROM customers;
```

```
ê³ ê° ìˆ˜
----
59
```

### 5. ê³ ê°(customers) í…Œì´ë¸”ì—ì„œ ê³ ê°ì´ ì‚¬ëŠ” ë‚˜ë¼ê°€ `USA`ì¸ ê³ ê°ì˜ `FirstName`, `LastName`ì„ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, ê°ê°ì˜ ì»¬ëŸ¼ëª…ì„ `ì´ë¦„`, `ì„±`ìœ¼ë¡œ ì¶œë ¥í•˜ê³ , `ì´ë¦„`ì„ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ 5ê°œê¹Œì§€ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT FirstName AS "ì´ë¦„", LastName AS "ì„±" FROM customers WHERE Country = 'USA' ORDER BY "ì´ë¦„" DESC LIMIT 5;
```

```
ì´ë¦„        ì„±
--------  ----------
Victor    Stevens
Tim       Goyer
Richard   Cunningham
Patrick   Gray
Michelle  Brooks
```

### 6. ì†¡ì¥(invoices) í…Œì´ë¸”ì—ì„œ `BillingPostalCode`ê°€ `NULL` ì´ ì•„ë‹Œ í–‰ì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, ì»¬ëŸ¼ëª…ì„ `ì†¡ì¥ìˆ˜`ë¡œ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT COUNT(*) AS "ì†¡ì¥ìˆ˜" FROM invoices WHERE BillingPostalCode IS NOT NULL;
```

```
ì†¡ì¥ìˆ˜
---
384
```

### 7. ì†¡ì¥(invoices) í…Œì´ë¸”ì—ì„œ `BillingState`ê°€ `NULL` ì¸ ë°ì´í„°ë¥¼ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, `InvoiceDate`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ 5ê°œê¹Œì§€ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT * FROM invoices WHERE BillingState IS NULL ORDER BY InvoiceDate DESC LIMIT 5;
```

```
InvoiceId  CustomerId  InvoiceDate          BillingAddress                            BillingCity   BillingState  BillingCountry  BillingPostalCode  Total
---------  ----------  -------------------  ----------------------------------------  ------------  ------------  --------------  -----------------  -----
412        58          2013-12-22 00:00:00  12,Community Centre                       Delhi                       India           110017             1.99
411        44          2013-12-14 00:00:00  Porthaninkatu 9                           Helsinki                    Finland         00530              13.86
410        35          2013-12-09 00:00:00  Rua dos Campeoes Europeus de Viena, 4350  Porto                       Portugal                           8.91
404        6           2013-11-13 00:00:00  Rilska 3174/6                             Prague                      Czech Republic  14300              25.86
403        56          2013-11-08 00:00:00  307 Macacha Guemes                        Buenos Aires                Argentina       1106               8.91
```

### 8. ì†¡ì¥(invoices) í…Œì´ë¸”ì—ì„œ `InvoiceDate`ì˜ ë…„ë„ê°€ `2013`ì¸ í–‰ì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•˜ì„¸ìš”.

| `strftime`ë¥¼ ê²€ìƒ‰í•´ì„œ í™œìš©í•´ë³´ì„¸ìš”.

```sql
SELECT COUNT(*) FROM invoices WHERE STRFTIME('%Y', InvoiceDate) = '2013';
```

```
COUNT(*)
--------
80
```

### 9. ê³ ê°(customers) í…Œì´ë¸”ì—ì„œ `FirstName`ì´ `L` ë¡œ ì‹œì‘í•˜ëŠ” ê³ ê°ì˜ `CustomerId`, `FirstName`, `LastName`ì„ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, ê°ê°ì˜ ì»¬ëŸ¼ëª…ì„ `ê³ ê°ID`, `ì´ë¦„`,`ì„±`ìœ¼ë¡œ ì¶œë ¥í•˜ê³ , `ê³ ê°ID`ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT CustomerId AS "ê³ ê°ID", FirstName AS "ì´ë¦„", LastName AS "ì„±" FROM customers WHERE SUBSTR(FirstName, 1, 1) = 'L' ORDER BY "ê³ ê°ID" ASC;
```

```
ê³ ê°ID  ì´ë¦„        ì„±
----  --------  ---------
1     Luis      Goncalves
2     Leonie    Kohler
45    Ladislav  Kovacs
47    Lucas     Mancini
57    Luis      Rojas
```

### 10. ê³ ê°(customers) í…Œì´ë¸”ì—ì„œ ê° ë‚˜ë¼ì˜ ê³ ê° ìˆ˜ì™€ í•´ë‹¹ ë‚˜ë¼ ì´ë¦„ì„ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, ê°ê°ì˜ ì»¬ë ´ëª…ì„ `ê³ ê° ìˆ˜`,`ë‚˜ë¼`ë¡œ ì¶œë ¥í•˜ê³ , ê³ ê° ìˆ˜ ìƒìœ„ 5ê°œì˜ ë‚˜ë¼ë§Œ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT COUNT(*) AS "ê³ ê° ìˆ˜", Country AS "ë‚˜ë¼" FROM customers GROUP BY Country ORDER BY "ê³ ê° ìˆ˜" DESC LIMIT 5;
```

```
ê³ ê° ìˆ˜  ë‚˜ë¼
----  -------
13    USA
8     Canada
5     France
5     Brazil
4     Germany
```

### 11. ì•¨ë²”(albums) í…Œì´ë¸”ì—ì„œ ê°€ì¥ ë§ì€ ì•¨ë²”ì´ ìˆëŠ” Artistì˜ `ArtistId`ì™€ `ì•¨ë²” ìˆ˜`ë¥¼ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT ArtistID, COUNT(*) AS "ì•¨ë²” ìˆ˜" FROM albums GROUP BY ArtistID ORDER BY "ì•¨ë²” ìˆ˜" DESC LIMIT 1;
```

```
ArtistId  ì•¨ë²” ìˆ˜
--------  ----
90        21
```

### 12. ì•¨ë²”(albums) í…Œì´ë¸”ì—ì„œ ë³´ìœ  ì•¨ë²” ìˆ˜ê°€ 10ê°œ ì´ìƒì¸ Artistì˜ `ArtistId`ì™€ `ì•¨ë²” ìˆ˜` ì¶œë ¥í•˜ì„¸ìš”

| ë‹¨, ì•¨ë²” ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT ArtistID, COUNT(*) AS "ì•¨ë²” ìˆ˜" FROM albums GROUP BY ArtistID HAVING COUNT(*) >= 10 ORDER BY "ì•¨ë²” ìˆ˜" DESC;
```

```sqlite
-- ì´ê²Œ ë˜ë„¤...
SELECT ArtistID, COUNT(*) AS "ì•¨ë²” ìˆ˜" FROM albums GROUP BY ArtistID HAVING "ì•¨ë²” ìˆ˜" >= 10 ORDER BY "ì•¨ë²” ìˆ˜" DESC;
```

```
ArtistId  ì•¨ë²” ìˆ˜
--------  ----
90        21
22        14
58        11
50        10
150       10
```

### 13. ê³ ê°(customers) í…Œì´ë¸”ì—ì„œ `State`ê°€ ì¡´ì¬í•˜ëŠ” ê³ ê°ë“¤ì„ `Country` ì™€ `State`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í™”í•´ì„œ ê° ê·¸ë£¹ì˜ `ê³ ê° ìˆ˜`, `Country`, `State` ë¥¼ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, `ê³ ê° ìˆ˜`, `Country` ìˆœì„œ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ 5ê°œê¹Œì§€ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT COUNT(*) AS "ê³ ê° ìˆ˜", Country, State FROM customers WHERE State IS NOT NULL GROUP BY Country, State ORDER BY "ê³ ê° ìˆ˜" DESC, Country DESC LIMIT 5;
```

```
ê³ ê° ìˆ˜  Country  State
----  -------  -----
3     USA      CA
3     Brazil   SP
2     Canada   ON
1     USA      WI
1     USA      WA
```

### 14. ê³ ê°(customers) í…Œì´ë¸”ì—ì„œ `Fax` ê°€ `NULL`ì¸ ê³ ê°ì€ 'X' NULLì´ ì•„ë‹Œ ê³ ê°ì€ 'O'ë¡œ `Fax ìœ /ë¬´` ì»¬ëŸ¼ì— í‘œì‹œí•˜ì—¬ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, `CustomerId`ì™€ `Fax ìœ /ë¬´` ì»¬ëŸ¼ë§Œ ì¶œë ¥í•˜ê³ , `CustomerId` ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ 5ê°œê¹Œì§€ ì¶œë ¥í•˜ì„¸ìš”.

```sql
SELECT CustomerID,
       CASE
           WHEN Fax IS NULL THEN 'X'
           ELSE 'O'
       END AS "Fax ìœ /ë¬´"
FROM customers
ORDER BY CustomerID ASC
LIMIT 5;
```

```
CustomerId  Fax ìœ /ë¬´
----------  -------
1           O
2           X
3           X
4           X
5           O
```

### 15. ì ì›(employees) í…Œì´ë¸”ì—ì„œ `ì˜¬í•´ë…„ë„ - BirthDate ë…„ë„ + 1` ë¥¼ ê³„ì‚°í•´ì„œ `ë‚˜ì´` ì»¬ëŸ¼ì— í‘œì‹œí•˜ì—¬ ì¶œë ¥í•˜ì„¸ìš”.

| ë‹¨, ì ì›ì˜ `LastName`, `FirstName`, `ë‚˜ì´` ì»¬ëŸ¼ë§Œ ì¶œë ¥í•˜ê³ , `EmployeeId`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì¶œë ¥í•˜ì„¸ìš”.

| cast(), strftime(), ì˜¤ëŠ˜ ë‚ ì§œë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜ë¥¼ ê²€ìƒ‰í•˜ê³ , í™œìš©í•´ë³´ì„¸ìš”.

```sql
SELECT LastName,
       FirstName,
       CAST(STRFTIME('%Y', CURRENT_TIMESTAMP, 'LOCALTIME') AS INT) - CAST(STRFTIME('%Y', BirthDate) AS INT) + 1 AS "ë‚˜ì´"
FROM employees
ORDER BY EmployeeId ASC;
```

```
LastName  FirstName  ë‚˜ì´
--------  ---------  --
Adams     Andrew     61
Edwards   Nancy      65
Peacock   Jane       50
Park      Margaret   76
Johnson   Steve      58
Mitchell  Michael    50
King      Robert     53
Callahan  Laura      55
```

### 16. ê°€ìˆ˜(artists) í…Œì´ë¸”ì—ì„œ ì•¨ë²”(albums)ì˜ ê°œìˆ˜ê°€ ê°€ì¥ ë§ì€ ê°€ìˆ˜ì˜ `Name`ì„ ì¶œë ¥í•˜ì„¸ìš”.

| artists í…Œì´ë¸”ê³¼ albums í…Œì´ë¸”ì˜ `ArtistId` í™œìš©í•˜ì„¸ìš”.

```sql
SELECT Name
FROM artists
WHERE ArtistId = (SELECT ArtistID
                  FROM albums
                  GROUP BY ArtistID
                  ORDER BY COUNT(*) DESC
                  LIMIT 1);
```

```
Name
-----------
Iron Maiden
```

### 17. ì¥ë¥´(genres) í…Œì´ë¸”ì—ì„œ ìŒì•…(tracks)ì˜ ê°œìˆ˜ê°€ ê°€ì¥ ì ì€ ì¥ë¥´ì˜ `Name`ì„ ì¶œë ¥í•˜ì„¸ìš”.

| genres í…Œì´ë¸”ê³¼ tracks í…Œì´ë¸”ì˜ `GenreId` í™œìš©í•˜ì„¸ìš”.

```sql
SELECT Name
FROM genres
WHERE GenreId = (SELECT GenreId
                 FROM tracks
                 GROUP BY GenreId
                 ORDER BY COUNT(*) ASC
                 LIMIT 1);
```

```
Name
-----
Opera
```
