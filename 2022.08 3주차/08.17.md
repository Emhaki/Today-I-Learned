# 8/17

# 🕓 9:00 ~ 6:00

## ✅ Database

### WHERE

```sql
Table 생성
CREATE TABLE 테이블이름(users)
```

### **users 테이블에서 age가 30 이상 조회**

```sql
​SELECT * FROM users WHERE age >= 30;
```

### **users 테이블에서 age가 30 이상인 사람 이름 조회**

```sql
​SELECT first_name FROM users WHERE age >= 30;
```

### **users 테이블에서 age가 30 이상이고 성이 '김'인 사람 조회**

```sql
SELECT age, first_name FROM users WHERE age >= 30 AND last_name = '김';
```

## ✅ WHERE절에서 사용할 수 있는 연산자

```py
비교 연산자
=, >, >= 등 대,소 동일 여부를 확인하는 연산자
논리 연산자
AND, OR, NOT(뒤에 오는 조건의 결과를 반대로)
```

### **SQL 사용 연산자**

```sql
BETWEEN 값1 AND 값2 두 값 사이의 비교
IN (값1, 값2) 목록 중에 하나라도 일치하면 성공
LIKE 비교 문자열과 형태 일치
IS NULL NULL 여부를 확인할 때
```

### **연산자 우선순위**

```sql
1순위 괄호
2순위 NOT
3순위 비교 연산자, SQL
4순위 AND
5순위 OR
```

## ✅ SQLite Aggregate Functions

### **집계 함수**

```SQL
값 집합에 대한 계산을 수행하고 단일 값을 반환
여러 행으로부터 하나의 결괏값을 반환하는 함수
SELECT 구문에서만 활용됨
COUNT
AVG 모든 값의 평균
MAX
MIN
SUM
```

### **계좌잔고가 가장 많은사람의 이름**

```sql
SELECT MAX(balance),first_name FROM users;
```

## ✅ LIKE

### **패턴 일치를 기반으로 데이터를 조회**

```sql
SQLite는 패턴 구성을 위한 2개의 wildcards를 제공
% -> 0개 이상의 문자
_ -> 임의의 단일 문자
```

## ✅ ORDER BY

```sql
조회 결과 집합을 정렬
SELECT 문에 추가하여 사용
정렬 순서를 위한 2개의 keyword 제공
ASC - 오름차순
DESC - 내림차순

users 에서 나이 순으로 오름차순 정렬하여 상위 10개 조회
SELECT * FROM users ORDER BY age ASC LIMIT 10;
users 에서 나이, 성 순으로 오름차순
SELECT * FROM users ORDER BY age, last_name LIMIT 10;
계좌 잔액 내림차순(높은->낮은 것), 성 오름차순(ㄱ->ㅎ)
SELECT last_name, first_name, balance FROM users ORDER BY balance DESC, last_name ASC LIMIT 10;
```

## ✅ 실습 문제

# 2일차 실습

## 사전 확인

### 실행

```bash
$ sqlite3 healthcare.sqlite3
```

### Column 출력 설정

```sql
sqlite3> .headers on
sqlite3> .mode column
```

### table 및 스키마 조회

```sql
sqlite3> .tables
healthcare

sqlite3> .schema healthcare
CREATE TABLE healthcare (
    id PRIMARY KEY,
    sido INTEGER NOT NULL,
    gender INTEGER NOT NULL,
    age INTEGER NOT NULL,
    height INTEGER NOT NULL,
    weight INTEGER NOT NULL,
    waist REAL NOT NULL,
    va_left REAL NOT NULL,
    va_right REAL NOT NULL,

    blood_pressure INTEGER
    NOT NULL,
    smoking INTEGER NOT NULL,
    is_drinking BOOLEAN NOT NULL
);
```

## 문제

### 1. 추가되어 있는 모든 데이터의 수를 출력하시오.

```sql
SELECT COUNT(*) FROM healthcare;
```

```
COUNT(*)
--------
1000000

```

### 2. 연령 코드(age)의 최대, 최소 값을 모두 출력하시오.

```sql
SELECT MAX(age), MIN(age) FROM healthcare;
```

```
MAX(age)  MIN(age)
--------  --------
18        9

```

### 3. 신장(height)과 체중(weight)의 최대, 최소 값을 모두 출력하시오.

```sql
SELECT MAX(height), MIN(height), MAX(weight), MIN(weight) FROM healthcare;
```

```
MAX(height)  MIN(height)  MAX(weight)  MIN(weight)
-----------  -----------  -----------  -----------
195          130          135          30
```

### 4. 신장(height)이 160이상 170이하인 사람은 몇 명인지 출력하시오.

```sql
SELECT COUNT(*) FROM healthcare WHERE height <= 170 AND height >= 160;
```

```
COUNT(*)
--------
516930
```

### 5. 음주(is_drinking)를 하는 사람(1)의 허리 둘레(waist)를 높은 순으로 5명 출력하시오.

```sql
SELECT waist FROM healthcare ORDER BY waist AND is_drinking = 1 DESC LIMIT 5;
```

```
waist
-----
94.0
93.0
63.0
90.0
89.0
```

### 6. 시력 양쪽(va_left, va_right)이 1.5이상이면서 음주(is_drinking)를 하는 사람의 수를 출력하시오.

```sql
SELECT COUNT(is_drinking=1) FROM healthcare WHERE va_left >= 1.5 AND va_right >= 1.5;
```

```
COUNT(is_drinking=1)
--------------------
50324
```

### 7. 혈압(blood_pressure)이 정상 범위(120미만)인 사람의 수를 출력하시오.

```sql
SELECT COUNT(*) FROM healthcare WHERE blood_pressure < 120;
```

```
COUNT(*)
--------
360808
```

### 8. 혈압(blood_pressure)이 140이상인 사람들의 평균 허리둘레(waist)를 출력하시오.

```sql
SELECT AVG(waist) FROM healthcare WHERE blood_pressure >= 140;
```

```
AVG(waist)
----------------
85.8665098512525
```

### 9. 성별(gender)이 1인 사람의 평균 키(height)와 평균 몸무게(weight)를 출력하시오.

```sql
SELECT AVG(height), AVG(weight) FROM healthcare WHERE gender = 1;
```

```
AVG(height)       AVG(weight)
----------------  ----------------
167.452735422145  69.7131620222875
```

### 10. 키가 가장 큰 사람 중에 두번째로 무거운 사람의 id와 키(height), 몸무게(weight)를 출력하시오.

```sql
SELECT id, height, weight FROM healthcare ORDER BY height DESC, weight DESC LIMIT 5;

```

```
id      height  weight
------  ------  ------
836005  195     110
```
